// Коллекция книг русской литературы 19 века для инициализации
const russianBooks = [
    // Пушкин
    { id: 1, title: 'Евгений Онегин', author: 'А.С. Пушкин', genre: 'Роман в стихах', year: 1833, description: 'Роман в стихах о жизни петербургского денди' },
    { 
        id: 2, 
        title: 'Капитанская дочка', 
        author: 'А.С. Пушкин', 
        genre: 'Повесть', 
        year: 1836, 
        description: 'Историческая повесть о пугачёвском восстании',
        chapters: [
            {
                title: 'Глава I. Сержант гвардии',
                content: `Береги честь смолоду.

— Кто его знает? Матушка! Служи верно, кому присягнешь; слушайся начальников; за их лаской не гонись; на службу не напрашивайся; от службы не отговаривайся; и помни пословицу: береги платье снову, а честь смолоду.

Мысль о скорой разлуке со мною так поразила матушку, что она уронила ложку в кастрюлю, и слёзы потекли по её лицу. Я крепко прижал к сердцу отца и матушку и ушёл на двор, где уже стояла кибитка.

Я выехал на крыльцо. Савельич шёл за мною, неся за плечами связку, в которой была уложена постель и узлы с разным скарбом.

— Что, — сказал мне Иван Игнатьич, когда мы остались одни, — хорош новый губернатор? Говорят, что он не малой руки; но слух, что он с Оренбурга отбыл… Будет ли он нам помощником?

Я отвечал ему, что думаю: откуда бы ни был губернатор, всё равно; дело в том, что мы не должны полагаться на одних только начальников. Правда, в старые годы люди были осторожнее…`
            },
            {
                title: 'Глава II. Вожатый',
                content: `Кто там? — спросил я Савельича.

— Я, барин, — отвечал голос из кибитки. — Не узнаёте? Я ваш бывший дядька Савельич.

Я выскочил из кибитки. Действительно, это был мой дядька. Я обрадовался и обнял его.

— Как ты здесь? — спросил я.

— А как же, барин? Узнав, что вы едете к новому месту службы, я решил вас проводить. Ведь вы ещё молоды; без меня вам будет скучно.

Я был тронут его преданностью и не стал его отговаривать. Мы поехали вместе.

Дорога шла по незнакомым мне местам. Я с любопытством осматривался кругом. Поля, перелески, деревеньки — всё было ново и необычно. Мне казалось, что я еду в какой-то другой мир, далёкий от дома, от знакомых мест.

Савельич тоже смотрел по сторонам и время от времени вздыхал.

— Что, дядя, скучаешь? — спросил я.

— Нет, барин, — отвечал он, — просто думаю: долгая ли нам дорога, много ли нас ожидает невзгод…`
            },
            {
                title: 'Глава III. Крепость',
                content: `Мы ехали степью. День был ясный, но холодный. Ветер дул в лицо и развевал мои волосы. Я сидел на облучке рядом с Савельичем и думал о том, что ожидает меня на новом месте.

— Скоро ли мы доедем? — спросил я ямщика.

— Долго ли ехать? Да вёрст пятьдесят осталось, не больше. К вечеру будем.

Я вздохнул и замолчал. Мне было грустно и тревожно. Я представлял себе крепость, где мне предстоит служить, и старался вообразить, какие там будут люди, какая обстановка.

Солнце уже клонилось к закату, когда мы увидели впереди небольшую крепость. Она стояла на холме и издали казалась маленькой и неприступной.

— Вот она, наша крепость, — сказал ямщик, указывая кнутом. — Белогорская крепость.

Я посмотрел на крепость с любопытством. Она была обнесена деревянной оградой, за которой виднелись крыши домов. У ворот стояли часовые. Всё выглядело уютно и спокойно.`
            }
        ]
    },
    { id: 3, title: 'Пиковая дама', author: 'А.С. Пушкин', genre: 'Повесть', year: 1834, description: 'Мистическая повесть о трёх картах' },
    { id: 4, title: 'Дубровский', author: 'А.С. Пушкин', genre: 'Повесть', year: 1841, description: 'Романтическая повесть о благородном разбойнике' },
    { id: 5, title: 'Повести Белкина', author: 'А.С. Пушкин', genre: 'Повести', year: 1831, description: 'Цикл повестей, рассказанных покойным Белкиным' },
    { id: 6, title: 'Выстрел', author: 'А.С. Пушкин', genre: 'Повесть', year: 1831, description: 'Одна из повестей Белкина о дуэли' },
    { 
        id: 7, 
        title: 'Метель', 
        author: 'А.С. Пушкин', 
        genre: 'Повесть', 
        year: 1831, 
        description: 'Романтическая повесть о случайном венчании',
        chapters: [
            {
                title: 'Метель',
                content: `В конце 1811 года, в эпоху нам достопамятную, жил в своём поместье Ненарадове добрый Гаврила Гаврилович Р**. Славился он во всей округе гостеприимством и радушием; соседи поминутно к нему ездили есть, пить, играть по пяти копеек в бостон и рассказывать ему новости. Жена его, Прасковья Петровна, была женщина добрая, и они жили душа в душу. У них была дочь Маша, семнадцати лет.

Маша была воспитана на французских романах и, следовательно, была влюблена. Предмет, избранный ею, был бедный армейский прапорщик, находившийся в отпуску в своей деревне. Само собою разумеется, что молодой человек пылал равною страстию и что родители возлюбленной, заметя их взаимную склонность, запретили дочери о нём и думать, а его принимали хуже, нежели отставного заседателя.

Влюблённые переписывались и виделись всякий день наедине в сосновой роще или у старой часовни. Там они клялись друг другу в вечной любви, сетовали на судьбу и делали различные предположения. Сочиняя письма, Марья Гавриловна употребляла стиль сентиментальный: звала его своим другом, обожала его и уверяла, что без его согласия не согласится ни на что в мире. Кончала она всегда просьбою убежать и венчаться тайно.

Время шло. Марья Гавриловна становилась всё беспокойнее и беспокойнее. Наконец она решилась. Назначили день побега, согласились, чтобы она вечером не ужинала и ушла бы спать в свою комнату под предлогом головной боли. Служанка её была в заговоре; обе должны были выйти в сад через заднее крыльцо, за садом найти готовые сани, сесть и ехать за пять вёрст от Ненарадова, в село Жадрино, прямо в церковь, где Владимир уже их ожидал.

Настал день, решительный день. Вечером Марья Гавриловна сказалась больною, отказалась от ужина и ушла в свою комнату. В назначенное время служанка начала укладывать её; Марья Гавриловна почти без памяти села в сани. Служанка велела кучеру ехать, и лошади понеслись.

Но судьба решила иначе. Поднялась метель, такая метель, какой не помнили старожилы. Ветер выл; метель была такая, что ничего не было видно в двух шагах. Лошади заблудились. Кучер не мог найти дороги. Они ехали долго, но не могли доехать до Жадрино.`
            }
        ]
    },
    { id: 8, title: 'Станционный смотритель', author: 'А.С. Пушкин', genre: 'Повесть', year: 1831, description: 'Трагическая история Самсона Вырина' },
    { id: 9, title: 'Барышня-крестьянка', author: 'А.С. Пушкин', genre: 'Повесть', year: 1831, description: 'Легкомысленная повесть о переодевании' },
    { id: 10, title: 'Медный всадник', author: 'А.С. Пушкин', genre: 'Поэма', year: 1833, description: 'Поэма о наводнении в Петербурге' },
    { id: 11, title: 'Руслан и Людмила', author: 'А.С. Пушкин', genre: 'Поэма', year: 1820, description: 'Сказочная поэма о богатыре и похищенной невесте' },
    { id: 12, title: 'Полтава', author: 'А.С. Пушкин', genre: 'Поэма', year: 1829, description: 'Историческая поэма о Полтавской битве' },
    { id: 13, title: 'Борис Годунов', author: 'А.С. Пушкин', genre: 'Драма', year: 1825, description: 'Трагедия о Смутном времени' },
    { id: 14, title: 'Скупой рыцарь', author: 'А.С. Пушкин', genre: 'Драма', year: 1830, description: 'Маленькая трагедия о власти золота' },
    { id: 15, title: 'Моцарт и Сальери', author: 'А.С. Пушкин', genre: 'Драма', year: 1830, description: 'Маленькая трагедия о зависти' },
    { id: 16, title: 'Каменный гость', author: 'А.С. Пушкин', genre: 'Драма', year: 1830, description: 'Маленькая трагедия о Дон Жуане' },
    { id: 17, title: 'Пир во время чумы', author: 'А.С. Пушкин', genre: 'Драма', year: 1830, description: 'Маленькая трагедия о жизни перед лицом смерти' },
    { id: 18, title: 'Стихотворения', author: 'А.С. Пушкин', genre: 'Лирика', year: 1826, description: 'Собрание лирических стихотворений' },
    { id: 19, title: 'История Пугачёва', author: 'А.С. Пушкин', genre: 'История', year: 1834, description: 'Историческое исследование о восстании' },
    { id: 20, title: 'История Петра', author: 'А.С. Пушкин', genre: 'История', year: 1835, description: 'Историческое исследование о Петре Великом' },
    
    // Лермонтов
    { id: 21, title: 'Герой нашего времени', author: 'М.Ю. Лермонтов', genre: 'Роман', year: 1840, description: 'Психологический роман о Печорине' },
    { id: 22, title: 'Мцыри', author: 'М.Ю. Лермонтов', genre: 'Поэма', year: 1840, description: 'Романтическая поэма о свободолюбивом юноше' },
    { id: 23, title: 'Демон', author: 'М.Ю. Лермонтов', genre: 'Поэма', year: 1841, description: 'Романтическая поэма о падшем ангеле' },
    { id: 24, title: 'Песня про царя Ивана Васильевича', author: 'М.Ю. Лермонтов', genre: 'Поэма', year: 1837, description: 'Былина о временах Ивана Грозного' },
    { id: 25, title: 'Бородино', author: 'М.Ю. Лермонтов', genre: 'Стихотворение', year: 1837, description: 'Баллада о Бородинском сражении' },
    { id: 26, title: 'Парус', author: 'М.Ю. Лермонтов', genre: 'Стихотворение', year: 1832, description: 'Философское стихотворение о поиске' },
    { id: 27, title: 'Смерть поэта', author: 'М.Ю. Лермонтов', genre: 'Стихотворение', year: 1837, description: 'Элегия на смерть Пушкина' },
    { id: 28, title: 'Родина', author: 'М.Ю. Лермонтов', genre: 'Стихотворение', year: 1841, description: 'Любовь к родине "странная"' },
    { id: 29, title: 'Маскарад', author: 'М.Ю. Лермонтов', genre: 'Драма', year: 1835, description: 'Драма о ревности и мести' },
    { id: 30, title: 'Стихотворения', author: 'М.Ю. Лермонтов', genre: 'Лирика', year: 1840, description: 'Сборник лирических стихотворений' },
    
    // Гоголь
    { id: 31, title: 'Мёртвые души', author: 'Н.В. Гоголь', genre: 'Поэма', year: 1842, description: 'Поэма о похождениях Чичикова' },
    { id: 32, title: 'Ревизор', author: 'Н.В. Гоголь', genre: 'Комедия', year: 1836, description: 'Комедия о мнимом ревизоре' },
    { id: 33, title: 'Тарас Бульба', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1842, description: 'Повесть о запорожских казаках' },
    { 
        id: 34, 
        title: 'Шинель', 
        author: 'Н.В. Гоголь', 
        genre: 'Повесть', 
        year: 1842, 
        description: 'Повесть о маленьком человеке',
        chapters: [
            {
                title: 'Часть I',
                content: `В департаменте... но лучше не называть, в каком департаменте. Нет ничего сердитее всякого рода департаментов, полков, канцелярий и, словом, всякого рода должностных сословий. Теперь уж всякий частный человек считает в лице своем оскорбленным всё общество.

Говорят, очень недавно поступила просьба от одного капитана-исправника, не помню какого-то города, в которой он изъясняет ясно, что гибнут государственные постановления и что священное его имя произносится решительно всуе. А в доказательство приложил к просьбе преогромнейший том какого-то романтического сочинения, где через каждые десять страниц является капитан-исправник, местами даже совершенно в пьяном виде.

Итак, чтобы избежать всяких неприятностей, лучше департамент, о котором идет дело, мы назовем одним департаментом. Итак, в одном департаменте служил один чиновник; чиновник нельзя сказать чтобы очень замечательный, низенького роста, несколько рябоват, несколько рыжеват, несколько даже на вид подслеповат, с небольшой лысиной на лбу, с морщинами по обеим сторонам щек и цветом лица что называется геморроидальным... Что ж делать! виноват петербургский климат.

Что касается до чина (ибо у нас прежде всего нужно объявить чин), то он был то, что называют вечный титулярный советник, над которым, как известно, натрунились и наострились вдоволь разные писатели, имеющие похвальное обыкновение налегать на тех, которые не могут кусаться.

Фамилия чиновника была Башмачкин. Уже по самому имени видно, что она когда-то произошла от башмака; но когда, в какое время и каким образом произошла она от башмака, ничего этого не известно. И отец, и дед, и даже шурин, и все совершенно Башмачкины, ходили в сапогах, переменяя только раза три в год подметки.`
            },
            {
                title: 'Часть II',
                content: `Итак, Акакий Акакиевич служил в одном департаменте. Никто не мог сказать, чтобы когда-нибудь видел его в каком-нибудь другом месте, кроме как на том месте, где он сидел; а сидел он всегда на одном и том же месте, писал всё одно и то же, так что думали, что он, верно, так и родился на свет уже совсем готовым, в вицмундире и с лысиной на голове.

В департаменте не оказывалось к нему никакого уважения. Сторожа не только не вставали с мест, когда он проходил, но даже не смотрели на него, как будто бы через приёмную пролетела простая муха. Начальники поступали с ним как-то холодно-деспотически. Какой-нибудь помощник столоначальника прямо совал ему под нос бумаги, не сказав даже "перепишите", или "вот интересное, хорошенькое дельце", или что-нибудь приятное, как употребляется в благовоспитанных службах. И он брал, посмотрев только на бумагу, и не глядел, кто ему подсунул и имеет ли право подсовывать.

Он брал просто из-за того, что она была бумага. Сразу же начинал переписывать. Молодые чиновники подсмеивались и острили над ним, во сколько хватало канцелярского остроумия, рассказывали тут же пред ним самим разные составленные про него истории; про его хозяйку, семидесятилетнюю старуху, говорили, что она бьет его, спрашивали, когда будет их свадьба, сыпали на голову ему бумажки, называя это снегом.

Но ни одного слова не отвечал на это Акакий Акакиевич, как будто бы никого не было пред ним; это не влияло даже на занятия его: среди всех этих докук он не делал ни одной ошибки в письме. Только если уж слишком была невыносима шутка, когда толкали его под руку, мешая заниматься своим делом, он произносил: "Оставьте меня, зачем вы меня обижаете?" И что-то странное заключалось в словах и в голосе, каким они были произнесены.`
            }
        ]
    },
    { id: 35, title: 'Нос', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1836, description: 'Фантастическая повесть о потерянном носе' },
    { id: 36, title: 'Портрет', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1842, description: 'Мистическая повесть о проклятом портрете' },
    { id: 37, title: 'Вечера на хуторе близ Диканьки', author: 'Н.В. Гоголь', genre: 'Повести', year: 1831, description: 'Цикл украинских повестей' },
    { id: 38, title: 'Ночь перед Рождеством', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1832, description: 'Сказочная повесть о Вакуле' },
    { id: 39, title: 'Сорочинская ярмарка', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1831, description: 'Весёлая повесть о ярмарке' },
    { id: 40, title: 'Майская ночь', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1831, description: 'Романтическая повесть с русалками' },
    { id: 41, title: 'Пропавшая грамота', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1831, description: 'Фантастическая повесть о поиске грамоты' },
    { id: 42, title: 'Заколдованное место', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1832, description: 'Мистическая повесть о кладе' },
    { id: 43, title: 'Миргород', author: 'Н.В. Гоголь', genre: 'Повести', year: 1835, description: 'Сборник повестей о провинции' },
    { id: 44, title: 'Вий', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1835, description: 'Мистическая повесть о демоне' },
    { id: 45, title: 'Старосветские помещики', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1835, description: 'Трогательная повесть о супружеской любви' },
    { id: 46, title: 'Петербургские повести', author: 'Н.В. Гоголь', genre: 'Повести', year: 1842, description: 'Цикл повестей о Петербурге' },
    { id: 47, title: 'Невский проспект', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1835, description: 'Философская повесть о Петербурге' },
    { id: 48, title: 'Записки сумасшедшего', author: 'Н.В. Гоголь', genre: 'Повесть', year: 1835, description: 'Повесть в форме дневника сумасшедшего' },
    { id: 49, title: 'Женитьба', author: 'Н.В. Гоголь', genre: 'Комедия', year: 1842, description: 'Комедия о застенчивом женихе' },
    { id: 50, title: 'Игроки', author: 'Н.В. Гоголь', genre: 'Комедия', year: 1842, description: 'Комедия о картёжниках' },
    
    // Тургенев
    { id: 51, title: 'Отцы и дети', author: 'И.С. Тургенев', genre: 'Роман', year: 1862, description: 'Роман о конфликте поколений' },
    { id: 52, title: 'Рудин', author: 'И.С. Тургенев', genre: 'Роман', year: 1856, description: 'Роман о "лишнем человеке"' },
    { id: 53, title: 'Дворянское гнездо', author: 'И.С. Тургенев', genre: 'Роман', year: 1859, description: 'Роман о дворянской усадьбе' },
    { id: 54, title: 'Накануне', author: 'И.С. Тургенев', genre: 'Роман', year: 1860, description: 'Роман о предчувствии перемен' },
    { id: 55, title: 'Записки охотника', author: 'И.С. Тургенев', genre: 'Рассказы', year: 1852, description: 'Цикл рассказов о русской деревне' },
    { 
        id: 56, 
        title: 'Муму', 
        author: 'И.С. Тургенев', 
        genre: 'Рассказ', 
        year: 1854, 
        description: 'Трагический рассказ о крепостном',
        chapters: [
            {
                title: 'Муму',
                content: `В одной из отдаленных улиц Москвы, в сером доме с белыми колоннами, антресолью и покривившимся балконом, жила некогда барыня, вдова, окруженная многочисленною дворней. Сыновья её служили в Петербурге, дочери вышли замуж; она выезжала редко и уединенно доживала скупости и скуки последние годы своей скучной и скупой старости. День её, нерадостный и ненастный, давно прошел; но и вечер её был чернее ночи.

Из числа всей её челяди самым замечательным лицом был дворник Герасим, мужчина двенадцати вершков роста, сложенный богатырем и глухонемой от рожденья. Барыня взяла его из деревни, где он жил один, в небольшой избенке, отдельно от братьев, и считался едва ли не самым исправным тягловым мужиком. Одаренный неимоверной силой, он работал за четверых — дело спорилось в его руках, и весело было смотреть на него, когда он либо пахал и, налегая огромными ладонями на соху, казалось, один, без помощи лошаденки, взрезывал упругую грудь земли, либо о Петров день так размашисто косил, что хоть бы молодой березовый лесок смахивать с корней долой, либо проворно и безостановочно молотил трехаршинным цепом, и как рычаг опускались и поднимались продолговатые и твердые мышцы его плечей.

Постоянное безмолвие придавало торжественную важность его неистомной работе. Славный он был мужик, и, не будь его несчастие, всякая девка охотно пошла бы за него замуж... Но вот Герасима привезли в Москву, купили ему сапоги, сшили кафтан на лето, на зиму тулуп, дали ему в руки метлу и лопату и определили его дворником.

Сначала ему сильно не понравилась его новая жизнь. С детства привыкший к полевым работам, к деревенскому быту, отчужденный своим несчастием от сообщества людей, он вырос немой и могучий, как дерево растет на плодородной почве... Переселенный в город, он не понимал, что с ним такое делается — скучал и недоумевал, как недоумевает молодой, здоровый бык, которого только что взяли с нивы, где росла сочная трава ему по колено, взяли, поставили на вагон железной дороги — и вот, обливаясь то пышными клубами дыма с искрами, то обдаваясь паром, мчится он бог весть куда, мчится стаей вагонов, а вокруг него гремят и визжат чугуны, стучат колеса железные, и качаются бревна, и грохочут машины!`
            }
        ]
    },
    { id: 57, title: 'Ася', author: 'И.С. Тургенев', genre: 'Повесть', year: 1858, description: 'Лирическая повесть о любви' },
    { id: 58, title: 'Первая любовь', author: 'И.С. Тургенев', genre: 'Повесть', year: 1860, description: 'Автобиографическая повесть' },
    { id: 59, title: 'Вешние воды', author: 'И.С. Тургенев', genre: 'Повесть', year: 1872, description: 'Повесть о первой любви' },
    { id: 60, title: 'Дым', author: 'И.С. Тургенев', genre: 'Роман', year: 1867, description: 'Роман о русском обществе' },
    { id: 61, title: 'Новь', author: 'И.С. Тургенев', genre: 'Роман', year: 1877, description: 'Роман о народничестве' },
    { id: 62, title: 'Калиныч', author: 'И.С. Тургенев', genre: 'Рассказ', year: 1847, description: 'Рассказ из цикла "Записки охотника"' },
    { id: 63, title: 'Хорь и Калиныч', author: 'И.С. Тургенев', genre: 'Рассказ', year: 1847, description: 'Рассказ о двух типах крестьян' },
    { id: 64, title: 'Бежин луг', author: 'И.С. Тургенев', genre: 'Рассказ', year: 1851, description: 'Рассказ о крестьянских детях' },
    { id: 65, title: 'Стихотворения в прозе', author: 'И.С. Тургенев', genre: 'Проза', year: 1882, description: 'Философские миниатюры' },
    
    // Достоевский
    { id: 66, title: 'Преступление и наказание', author: 'Ф.М. Достоевский', genre: 'Роман', year: 1866, description: 'Психологический роман о Раскольникове' },
    { id: 67, title: 'Идиот', author: 'Ф.М. Достоевский', genre: 'Роман', year: 1869, description: 'Роман о князе Мышкине' },
    { id: 68, title: 'Братья Карамазовы', author: 'Ф.М. Достоевский', genre: 'Роман', year: 1880, description: 'Философский роман о братьях' },
    { id: 69, title: 'Бесы', author: 'Ф.М. Достоевский', genre: 'Роман', year: 1872, description: 'Роман о революционерах' },
    { id: 70, title: 'Подросток', author: 'Ф.М. Достоевский', genre: 'Роман', year: 1875, description: 'Роман о становлении личности' },
    { id: 71, title: 'Униженные и оскорблённые', author: 'Ф.М. Достоевский', genre: 'Роман', year: 1861, description: 'Роман о страдании маленьких людей' },
    { id: 72, title: 'Игрок', author: 'Ф.М. Достоевский', genre: 'Роман', year: 1866, description: 'Роман о страсти к игре' },
    { id: 73, title: 'Бедные люди', author: 'Ф.М. Достоевский', genre: 'Роман', year: 1846, description: 'Роман в письмах о бедняках' },
    { id: 74, title: 'Белые ночи', author: 'Ф.М. Достоевский', genre: 'Повесть', year: 1848, description: 'Сентиментальная повесть о мечтателе' },
    { id: 75, title: 'Неточка Незванова', author: 'Ф.М. Достоевский', genre: 'Повесть', year: 1849, description: 'Неоконченная повесть о девочке' },
    { id: 76, title: 'Село Степанчиково', author: 'Ф.М. Достоевский', genre: 'Повесть', year: 1859, description: 'Сатирическая повесть о Фоме Опискине' },
    { id: 77, title: 'Записки из мёртвого дома', author: 'Ф.М. Достоевский', genre: 'Повесть', year: 1862, description: 'Очерки о каторге' },
    { id: 78, title: 'Записки из подполья', author: 'Ф.М. Достоевский', genre: 'Повесть', year: 1864, description: 'Философская повесть' },
    { id: 79, title: 'Вечный муж', author: 'Ф.М. Достоевский', genre: 'Повесть', year: 1870, description: 'Повесть о ревности' },
    { id: 80, title: 'Двойник', author: 'Ф.М. Достоевский', genre: 'Повесть', year: 1846, description: 'Фантастическая повесть о двойнике' },
    
    // Толстой
    { id: 81, title: 'Война и мир', author: 'Л.Н. Толстой', genre: 'Роман-эпопея', year: 1869, description: 'Эпопея о войне 1812 года' },
    { id: 82, title: 'Анна Каренина', author: 'Л.Н. Толстой', genre: 'Роман', year: 1877, description: 'Роман о трагической любви' },
    { id: 83, title: 'Воскресение', author: 'Л.Н. Толстой', genre: 'Роман', year: 1899, description: 'Роман о моральном возрождении' },
    { id: 84, title: 'Казаки', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1863, description: 'Повесть о жизни на Кавказе' },
    { id: 85, title: 'Севастопольские рассказы', author: 'Л.Н. Толстой', genre: 'Рассказы', year: 1855, description: 'Рассказы о Крымской войне' },
    { id: 86, title: 'Хаджи-Мурат', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1912, description: 'Повесть о кавказском горце' },
    { id: 87, title: 'Смерть Ивана Ильича', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1886, description: 'Повесть о смерти чиновника' },
    { id: 88, title: 'Крейцерова соната', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1890, description: 'Повесть о ревности и убийстве' },
    { id: 89, title: 'Отец Сергий', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1911, description: 'Повесть о духовных исканиях' },
    { id: 90, title: 'После бала', author: 'Л.Н. Толстой', genre: 'Рассказ', year: 1911, description: 'Рассказ о жестокости власти' },
    { id: 91, title: 'Детство', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1852, description: 'Первая часть автобиографической трилогии' },
    { id: 92, title: 'Отрочество', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1854, description: 'Вторая часть трилогии' },
    { id: 93, title: 'Юность', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1857, description: 'Третья часть трилогии' },
    { id: 94, title: 'Холстомер', author: 'Л.Н. Толстой', genre: 'Повесть', year: 1886, description: 'Повесть от лица лошади' },
    { id: 95, title: 'Кавказский пленник', author: 'Л.Н. Толстой', genre: 'Рассказ', year: 1872, description: 'Рассказ о пленении на Кавказе' },
    
    // Чехов
    { id: 96, title: 'Вишнёвый сад', author: 'А.П. Чехов', genre: 'Пьеса', year: 1904, description: 'Лирическая комедия о смене эпох' },
    { id: 97, title: 'Чайка', author: 'А.П. Чехов', genre: 'Пьеса', year: 1896, description: 'Комедия о любви и искусстве' },
    { id: 98, title: 'Дядя Ваня', author: 'А.П. Чехов', genre: 'Пьеса', year: 1897, description: 'Сцены из деревенской жизни' },
    { id: 99, title: 'Три сестры', author: 'А.П. Чехов', genre: 'Пьеса', year: 1901, description: 'Драма о надеждах и разочарованиях' },
    { id: 100, title: 'Палата №6', author: 'А.П. Чехов', genre: 'Повесть', year: 1892, description: 'Повесть о сумасшедшем доме' },
    { id: 101, title: 'Дама с собачкой', author: 'А.П. Чехов', genre: 'Рассказ', year: 1899, description: 'Рассказ о любви' },
    { id: 102, title: 'Человек в футляре', author: 'А.П. Чехов', genre: 'Рассказ', year: 1898, description: 'Рассказ о Беликове' },
    { id: 103, title: 'Крыжовник', author: 'А.П. Чехов', genre: 'Рассказ', year: 1898, description: 'Рассказ о мещанском счастье' },
    { id: 104, title: 'О любви', author: 'А.П. Чехов', genre: 'Рассказ', year: 1898, description: 'Рассказ о невысказанной любви' },
    { id: 105, title: 'Ионыч', author: 'А.П. Чехов', genre: 'Рассказ', year: 1898, description: 'Рассказ о духовном оскудении' },
    { id: 106, title: 'Студент', author: 'А.П. Чехов', genre: 'Рассказ', year: 1894, description: 'Философский рассказ' },
    { id: 107, title: 'Попрыгунья', author: 'А.П. Чехов', genre: 'Рассказ', year: 1892, description: 'Рассказ о легкомысленной жене' },
    { id: 108, title: 'Душечка', author: 'А.П. Чехов', genre: 'Рассказ', year: 1899, description: 'Рассказ о любящей женщине' },
    { id: 109, title: 'Смерть чиновника', author: 'А.П. Чехов', genre: 'Рассказ', year: 1883, description: 'Юмористический рассказ' },
    { id: 110, title: 'Толстый и тонкий', author: 'А.П. Чехов', genre: 'Рассказ', year: 1883, description: 'Сатирический рассказ' },
    { id: 111, title: 'Хамелеон', author: 'А.П. Чехов', genre: 'Рассказ', year: 1884, description: 'Сатирический рассказ о приспособленчестве' },
    { id: 112, title: 'Лошадиная фамилия', author: 'А.П. Чехов', genre: 'Рассказ', year: 1885, description: 'Юмористический рассказ' },
    { id: 113, title: 'Ванька', author: 'А.П. Чехов', genre: 'Рассказ', year: 1886, description: 'Трагический рассказ о мальчике' },
    { id: 114, title: 'Каштанка', author: 'А.П. Чехов', genre: 'Рассказ', year: 1887, description: 'Рассказ о собаке' },
    { id: 115, title: 'Спать хочется', author: 'А.П. Чехов', genre: 'Рассказ', year: 1888, description: 'Трагический рассказ о девочке-няне' },
    
    // Гончаров
    { id: 116, title: 'Обломов', author: 'И.А. Гончаров', genre: 'Роман', year: 1859, description: 'Роман о "лишнем человеке"' },
    { id: 117, title: 'Обыкновенная история', author: 'И.А. Гончаров', genre: 'Роман', year: 1847, description: 'Роман о провинциальном юноше' },
    { id: 118, title: 'Обрыв', author: 'И.А. Гончаров', genre: 'Роман', year: 1869, description: 'Роман о трёх поколениях' },
    { id: 119, title: 'Фрегат "Паллада"', author: 'И.А. Гончаров', genre: 'Очерки', year: 1858, description: 'Путевые очерки о кругосветном плавании' },
    
    // Островский
    { id: 120, title: 'Гроза', author: 'А.Н. Островский', genre: 'Драма', year: 1859, description: 'Драма о купеческой жизни' },
    { id: 121, title: 'Бесприданница', author: 'А.Н. Островский', genre: 'Драма', year: 1878, description: 'Драма о бедной невесте' },
    { id: 122, title: 'Снегурочка', author: 'А.Н. Островский', genre: 'Пьеса', year: 1873, description: 'Весенняя сказка' },
    { id: 123, title: 'Свои люди - сочтёмся', author: 'А.Н. Островский', genre: 'Комедия', year: 1850, description: 'Комедия о мошенниках' },
    { id: 124, title: 'На всякого мудреца довольно простоты', author: 'А.Н. Островский', genre: 'Комедия', year: 1868, description: 'Сатирическая комедия' },
    { id: 125, title: 'Лес', author: 'А.Н. Островский', genre: 'Комедия', year: 1871, description: 'Комедия о провинциальном театре' },
    { id: 126, title: 'Бешеные деньги', author: 'А.Н. Островский', genre: 'Комедия', year: 1870, description: 'Комедия о стяжательстве' },
    { id: 127, title: 'Волки и овцы', author: 'А.Н. Островский', genre: 'Комедия', year: 1875, description: 'Комедия о провинциальных интригах' },
    { id: 128, title: 'Без вины виноватые', author: 'А.Н. Островский', genre: 'Драма', year: 1884, description: 'Драма о матери и сыне' },
    { id: 129, title: 'Таланты и поклонники', author: 'А.Н. Островский', genre: 'Комедия', year: 1882, description: 'Комедия о театре' },
    
    // Некрасов
    { id: 130, title: 'Кому на Руси жить хорошо', author: 'Н.А. Некрасов', genre: 'Поэма', year: 1877, description: 'Эпическая поэма о народе' },
    { id: 131, title: 'Русские женщины', author: 'Н.А. Некрасов', genre: 'Поэма', year: 1872, description: 'Поэма о жёнах декабристов' },
    { id: 132, title: 'Мороз, Красный нос', author: 'Н.А. Некрасов', genre: 'Поэма', year: 1863, description: 'Поэма о крестьянской доле' },
    { id: 133, title: 'Дедушка', author: 'Н.А. Некрасов', genre: 'Поэма', year: 1870, description: 'Поэма о декабристе' },
    { id: 134, title: 'Стихотворения', author: 'Н.А. Некрасов', genre: 'Лирика', year: 1856, description: 'Сборник гражданской лирики' },
    { id: 135, title: 'Размышления у парадного подъезда', author: 'Н.А. Некрасов', genre: 'Стихотворение', year: 1858, description: 'Гражданское стихотворение' },
    { id: 136, title: 'Железная дорога', author: 'Н.А. Некрасов', genre: 'Стихотворение', year: 1864, description: 'Стихотворение о строителях' },
    { id: 137, title: 'Тройка', author: 'Н.А. Некрасов', genre: 'Стихотворение', year: 1846, description: 'Народная песня' },
    { id: 138, title: 'Вчерашний день, часу в шестом', author: 'Н.А. Некрасов', genre: 'Стихотворение', year: 1848, description: 'Стихотворение о Музе' },
    
    // Тютчев
    { id: 139, title: 'Стихотворения', author: 'Ф.И. Тютчев', genre: 'Лирика', year: 1854, description: 'Сборник философской лирики' },
    { id: 140, title: 'Весенняя гроза', author: 'Ф.И. Тютчев', genre: 'Стихотворение', year: 1828, description: 'Лирическое стихотворение о природе' },
    { id: 141, title: 'Silentium!', author: 'Ф.И. Тютчев', genre: 'Стихотворение', year: 1830, description: 'Философское стихотворение о молчании' },
    { id: 142, title: 'Умом Россию не понять', author: 'Ф.И. Тютчев', genre: 'Стихотворение', year: 1866, description: 'Известное четверостишие' },
    { id: 143, title: 'Есть в осени первоначальной', author: 'Ф.И. Тютчев', genre: 'Стихотворение', year: 1857, description: 'Пейзажная лирика' },
    { id: 144, title: 'Люблю грозу в начале мая', author: 'Ф.И. Тютчев', genre: 'Стихотворение', year: 1828, description: 'Стихотворение о весне' },
    
    // Фет
    { id: 145, title: 'Стихотворения', author: 'А.А. Фет', genre: 'Лирика', year: 1850, description: 'Сборник лирических стихотворений' },
    { id: 146, title: 'Шёпот, робкое дыханье', author: 'А.А. Фет', genre: 'Стихотворение', year: 1850, description: 'Лирическое стихотворение' },
    { id: 147, title: 'Я пришёл к тебе с приветом', author: 'А.А. Фет', genre: 'Стихотворение', year: 1843, description: 'Любовная лирика' },
    { id: 148, title: 'На заре ты её не буди', author: 'А.А. Фет', genre: 'Стихотворение', year: 1842, description: 'Романтическое стихотворение' },
    
    // Салтыков-Щедрин
    { id: 149, title: 'История одного города', author: 'М.Е. Салтыков-Щедрин', genre: 'Сатира', year: 1870, description: 'Сатирическая хроника о Глупове' },
    { id: 150, title: 'Господа Головлёвы', author: 'М.Е. Салтыков-Щедрин', genre: 'Роман', year: 1880, description: 'Роман о вырождении дворянства' },
    { id: 151, title: 'Сказки', author: 'М.Е. Салтыков-Щедрин', genre: 'Сатира', year: 1886, description: 'Сборник сатирических сказок' },
    { id: 152, title: 'Повесть о том, как один мужик двух генералов прокормил', author: 'М.Е. Салтыков-Щедрин', genre: 'Сказка', year: 1869, description: 'Сатирическая сказка' },
    { id: 153, title: 'Премудрый пескарь', author: 'М.Е. Салтыков-Щедрин', genre: 'Сказка', year: 1883, description: 'Сатирическая сказка о трусости' },
    { id: 154, title: 'Дикий помещик', author: 'М.Е. Салтыков-Щедрин', genre: 'Сказка', year: 1869, description: 'Сатирическая сказка' },
    { id: 155, title: 'Коняга', author: 'М.Е. Салтыков-Щедрин', genre: 'Сказка', year: 1885, description: 'Аллегорическая сказка' },
    
    // Лесков
    { id: 156, title: 'Левша', author: 'Н.С. Лесков', genre: 'Повесть', year: 1881, description: 'Сказ о тульском мастере' },
    { id: 157, title: 'Очарованный странник', author: 'Н.С. Лесков', genre: 'Повесть', year: 1873, description: 'Повесть о странствующем монахе' },
    { id: 158, title: 'Леди Макбет Мценского уезда', author: 'Н.С. Лесков', genre: 'Повесть', year: 1865, description: 'Драматическая повесть' },
    { id: 159, title: 'Тупейный художник', author: 'Н.С. Лесков', genre: 'Рассказ', year: 1883, description: 'Рассказ о крепостном искусстве' },
    { id: 160, title: 'На ножах', author: 'Н.С. Лесков', genre: 'Роман', year: 1871, description: 'Роман о нигилистах' },
    { id: 161, title: 'Соборяне', author: 'Н.С. Лесков', genre: 'Роман', year: 1872, description: 'Хроника о провинциальном духовенстве' },
    
    // Гаршин
    { id: 162, title: 'Красный цветок', author: 'В.М. Гаршин', genre: 'Рассказ', year: 1883, description: 'Рассказ о сумасшедшем' },
    { id: 163, title: 'Сигнал', author: 'В.М. Гаршин', genre: 'Рассказ', year: 1887, description: 'Рассказ о жертве' },
    { id: 164, title: 'То, чего не было', author: 'В.М. Гаршин', genre: 'Сказка', year: 1882, description: 'Философская сказка' },
    { id: 165, title: 'Четыре дня', author: 'В.М. Гаршин', genre: 'Рассказ', year: 1877, description: 'Рассказ о войне' },
    
    // Короленко
    { id: 166, title: 'Дети подземелья', author: 'В.Г. Короленко', genre: 'Повесть', year: 1885, description: 'Повесть о детской дружбе' },
    { id: 167, title: 'Слепой музыкант', author: 'В.Г. Короленко', genre: 'Повесть', year: 1886, description: 'Повесть о преодолении' },
    { id: 168, title: 'В дурном обществе', author: 'В.Г. Короленко', genre: 'Повесть', year: 1885, description: 'Повесть о милосердии' },
    { id: 169, title: 'Река играет', author: 'В.Г. Короленко', genre: 'Рассказ', year: 1892, description: 'Рассказ о паромщике' },
    
    // Сухово-Кобылин
    { id: 170, title: 'Свадьба Кречинского', author: 'А.В. Сухово-Кобылин', genre: 'Комедия', year: 1855, description: 'Комедия о мошеннике' },
    { id: 171, title: 'Дело', author: 'А.В. Сухово-Кобылин', genre: 'Драма', year: 1861, description: 'Драма о судебной волоките' },
    
    // Писемский
    { id: 172, title: 'Тысяча душ', author: 'А.Ф. Писемский', genre: 'Роман', year: 1858, description: 'Роман о чиновнике' },
    { id: 173, title: 'Горькая судьбина', author: 'А.Ф. Писемский', genre: 'Драма', year: 1859, description: 'Драма о крепостном праве' },
    
    // Мельников-Печерский
    { id: 174, title: 'В лесах', author: 'П.И. Мельников-Печерский', genre: 'Роман', year: 1874, description: 'Роман о заволжских старообрядцах' },
    { id: 175, title: 'На горах', author: 'П.И. Мельников-Печерский', genre: 'Роман', year: 1881, description: 'Продолжение романа о старообрядцах' },
    
    // Аксаков
    { id: 176, title: 'Семейная хроника', author: 'С.Т. Аксаков', genre: 'Повесть', year: 1856, description: 'Автобиографическая повесть' },
    { id: 177, title: 'Детские годы Багрова-внука', author: 'С.Т. Аксаков', genre: 'Повесть', year: 1858, description: 'Повесть о детстве' },
    { id: 178, title: 'Аленький цветочек', author: 'С.Т. Аксаков', genre: 'Сказка', year: 1858, description: 'Русская версия "Красавицы и чудовища"' },
    
    // Пушкин - дополнительная лирика
    { id: 179, title: 'Я помню чудное мгновенье', author: 'А.С. Пушкин', genre: 'Стихотворение', year: 1825, description: 'Послание к Керн' },
    { id: 180, title: 'Я вас любил', author: 'А.С. Пушкин', genre: 'Стихотворение', year: 1829, description: 'Любовное стихотворение' },
    { id: 181, title: 'Пророк', author: 'А.С. Пушкин', genre: 'Стихотворение', year: 1826, description: 'Философское стихотворение' },
    { id: 182, title: 'Памятник', author: 'А.С. Пушкин', genre: 'Стихотворение', year: 1836, description: 'Подведение итогов' },
    { id: 183, title: 'Осень', author: 'А.С. Пушкин', genre: 'Стихотворение', year: 1833, description: 'Пейзажная лирика' },
    
    // Тютчев - дополнительная лирика
    { id: 184, title: 'Я встретил вас', author: 'Ф.И. Тютчев', genre: 'Стихотворение', year: 1870, description: 'Стихотворение о любви' },
    { id: 185, title: 'О, как убийственно мы любим', author: 'Ф.И. Тютчев', genre: 'Стихотворение', year: 1851, description: 'Любовная лирика' },
    
    // Лермонтов - дополнительная лирика
    { id: 186, title: 'И скучно и грустно', author: 'М.Ю. Лермонтов', genre: 'Стихотворение', year: 1840, description: 'Философская лирика' },
    { id: 187, title: 'Молитва', author: 'М.Ю. Лермонтов', genre: 'Стихотворение', year: 1839, description: 'Духовная лирика' },
    { id: 188, title: 'Когда волнуется желтеющая нива', author: 'М.Ю. Лермонтов', genre: 'Стихотворение', year: 1837, description: 'Пейзажная лирика' },
    
    // Некрасов - дополнительная лирика
    { id: 189, title: 'Поэт и гражданин', author: 'Н.А. Некрасов', genre: 'Стихотворение', year: 1856, description: 'Гражданская лирика' },
    { id: 190, title: 'Элегия', author: 'Н.А. Некрасов', genre: 'Стихотворение', year: 1874, description: 'Философская элегия' },
    
    // Фет - дополнительная лирика
    { id: 191, title: 'Вечер', author: 'А.А. Фет', genre: 'Стихотворение', year: 1855, description: 'Пейзажная лирика' },
    { id: 192, title: 'Это утро, радость эта', author: 'А.А. Фет', genre: 'Стихотворение', year: 1881, description: 'Лирическое стихотворение' },
    
    // Чехов - дополнительные рассказы
    { id: 193, title: 'Анна на шее', author: 'А.П. Чехов', genre: 'Рассказ', year: 1895, description: 'Рассказ о замужестве' },
    { id: 194, title: 'Дом с мезонином', author: 'А.П. Чехов', genre: 'Рассказ', year: 1896, description: 'Рассказ о несбывшейся любви' },
    { id: 195, title: 'Чёрный монах', author: 'А.П. Чехов', genre: 'Рассказ', year: 1894, description: 'Рассказ о галлюцинациях' },
    { id: 196, title: 'Скрипка Ротшильда', author: 'А.П. Чехов', genre: 'Рассказ', year: 1894, description: 'Рассказ о музыканте' },
    
    // Тургенев - дополнительные произведения
    { id: 197, title: 'Фауст', author: 'И.С. Тургенев', genre: 'Повесть', year: 1856, description: 'Повесть о влиянии искусства' },
    { id: 198, title: 'Призраки', author: 'И.С. Тургенев', genre: 'Повесть', year: 1864, description: 'Фантастическая повесть' },
    
    // Достоевский - дополнительные произведения
    { id: 199, title: 'Бобок', author: 'Ф.М. Достоевский', genre: 'Рассказ', year: 1873, description: 'Фантастический рассказ о мёртвых' },
    { id: 200, title: 'Мальчик у Христа на ёлке', author: 'Ф.М. Достоевский', genre: 'Рассказ', year: 1876, description: 'Рождественский рассказ' }
];

// Хранилище книг (используем localStorage для персистентности)
let books = JSON.parse(localStorage.getItem('libraryBooks')) || [];
let editingBookId = null;

// Переменные для чтения книг
let currentReadingBook = null;
let currentChapterIndex = 0;

// Инициализация библиотеки книгами русской литературы 19 века
function initializeLibrary() {
    const libraryVersion = 'russian_literature_19th_century_v1';
    const savedVersion = localStorage.getItem('libraryVersion');
    
    // Если версия не совпадает или библиотека не инициализирована, загружаем книги
    if (savedVersion !== libraryVersion || books.length === 0) {
        books = russianBooks.map(book => ({ ...book }));
        saveBooks();
        localStorage.setItem('libraryVersion', libraryVersion);
        localStorage.setItem('libraryInitialized', 'true');
    }
}

// Инициализация при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    initializeLibrary();
    updateBookCount();
    renderBooks();
    
    // Добавляем обработчик для поиска в реальном времени
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.addEventListener('input', function(e) {
            renderBooks(e.target.value);
        });
    }
    
    // Обработчики для модального окна чтения
    const modal = document.getElementById('readerModal');
    if (modal) {
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeReader();
            }
        });
    }
    
    // Закрытие по клавише Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            const modal = document.getElementById('readerModal');
            if (modal && modal.style.display !== 'none') {
                closeReader();
            }
        }
    });
});

// Обработка отправки формы
function handleSubmit(event) {
    event.preventDefault();
    
    const title = document.getElementById('title').value.trim();
    const author = document.getElementById('author').value.trim();
    const genre = document.getElementById('genre').value.trim();
    const year = document.getElementById('year').value;
    const description = document.getElementById('description').value.trim();
    
    if (editingBookId !== null) {
        // Обновление существующей книги
        updateBook(editingBookId, {
            title,
            author,
            genre,
            year: year ? parseInt(year) : null,
            description
        });
    } else {
        // Добавление новой книги
        addBook({
            title,
            author,
            genre,
            year: year ? parseInt(year) : null,
            description,
            id: generateNewId() // Генерация уникального ID
        });
    }
    
    // Очистка формы
    resetForm();
}

// Добавление книги
function addBook(book) {
    books.push(book);
    saveBooks();
    renderBooks();
    updateBookCount();
    showNotification('Книга успешно добавлена!');
}

// Обновление книги
function updateBook(id, updatedData) {
    const index = books.findIndex(book => book.id === id);
    if (index !== -1) {
        books[index] = { ...books[index], ...updatedData };
        saveBooks();
        renderBooks();
        updateBookCount();
        showNotification('Книга успешно обновлена!');
    }
}

// Удаление книги
function deleteBook(id) {
    if (confirm('Вы уверены, что хотите удалить эту книгу?')) {
        books = books.filter(book => book.id !== id);
        saveBooks();
        renderBooks();
        updateBookCount();
        showNotification('Книга удалена!');
    }
}

// Редактирование книги
function editBook(id) {
    const book = books.find(b => b.id === id);
    if (!book) return;
    
    editingBookId = id;
    
    // Заполнение формы данными книги
    document.getElementById('bookId').value = id;
    document.getElementById('title').value = book.title || '';
    document.getElementById('author').value = book.author || '';
    document.getElementById('genre').value = book.genre || '';
    document.getElementById('year').value = book.year || '';
    document.getElementById('description').value = book.description || '';
    
    // Изменение заголовка и кнопки
    document.getElementById('formTitle').textContent = 'Редактировать книгу';
    document.getElementById('submitBtn').textContent = 'Сохранить изменения';
    document.getElementById('cancelBtn').style.display = 'block';
    
    // Прокрутка к форме
    document.querySelector('.form-section').scrollIntoView({ behavior: 'smooth' });
}

// Отмена редактирования
function cancelEdit() {
    resetForm();
}

// Сброс формы
function resetForm() {
    editingBookId = null;
    document.getElementById('bookForm').reset();
    document.getElementById('bookId').value = '';
    document.getElementById('formTitle').textContent = 'Добавить новую книгу';
    document.getElementById('submitBtn').textContent = 'Добавить книгу';
    document.getElementById('cancelBtn').style.display = 'none';
}

// Поиск книг
function searchBooks(query) {
    if (!query || !query.trim()) return books;
    
    const lowerQuery = query.toLowerCase().trim();
    return books.filter(book => 
        (book.title && book.title.toLowerCase().includes(lowerQuery)) ||
        (book.author && book.author.toLowerCase().includes(lowerQuery)) ||
        (book.genre && book.genre.toLowerCase().includes(lowerQuery))
    );
}

// Очистка поиска
function clearSearch() {
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.value = '';
        updateBookCount();
        renderBooks();
    }
}

// Отображение книг
function renderBooks(searchQuery = '') {
    const booksList = document.getElementById('booksList');
    const noBooksMessage = document.getElementById('noBooks');
    
    if (!booksList || !noBooksMessage) return; // Проверка на существование элементов
    
    booksList.innerHTML = '';
    
    // Обрезаем пробелы и приводим к нижнему регистру для поиска
    const trimmedQuery = searchQuery ? searchQuery.trim() : '';
    const filteredBooks = trimmedQuery ? searchBooks(trimmedQuery) : books;
    
    if (filteredBooks.length === 0) {
        booksList.style.display = 'none';
        noBooksMessage.style.display = 'block';
    } else {
        booksList.style.display = 'grid';
        noBooksMessage.style.display = 'none';
        
        filteredBooks.forEach(book => {
            const bookCard = createBookCard(book);
            booksList.appendChild(bookCard);
        });
    }
}

// Создание карточки книги
function createBookCard(book) {
    const card = document.createElement('div');
    card.className = 'book-card';
    
    card.innerHTML = `
        <h3>${escapeHtml(book.title)}</h3>
        <div class="author">${escapeHtml(book.author)}</div>
        ${book.genre ? `<span class="genre">${escapeHtml(book.genre)}</span>` : ''}
        ${book.year ? `<div class="year">Год издания: ${book.year}</div>` : ''}
        ${book.description ? `<div class="description">${escapeHtml(book.description)}</div>` : ''}
        <div class="book-actions">
            <button class="btn btn-read" onclick="openReader(${book.id})">📖 Читать</button>
            <button class="btn btn-edit" onclick="editBook(${book.id})">Редактировать</button>
            <button class="btn btn-danger" onclick="deleteBook(${book.id})">Удалить</button>
        </div>
    `;
    
    return card;
}

// Обновление счетчика книг
function updateBookCount() {
    const bookCountElement = document.getElementById('bookCount');
    if (bookCountElement) {
        bookCountElement.textContent = books.length;
    }
}

// Сохранение книг в localStorage
function saveBooks() {
    localStorage.setItem('libraryBooks', JSON.stringify(books));
}

// Генерация нового уникального ID
function generateNewId() {
    if (books.length === 0) {
        return 10000; // Начинаем с большого числа, чтобы избежать конфликтов
    }
    const maxId = Math.max(...books.map(book => book.id), 10000);
    return maxId + 1;
}

// Экранирование HTML для безопасности
function escapeHtml(text) {
    if (!text) return '';
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// Показ уведомления (простая версия)
function showNotification(message) {
    // Создаем временное уведомление
    const notification = document.createElement('div');
    notification.textContent = message;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: #28a745;
        color: white;
        padding: 15px 25px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        z-index: 1000;
        animation: slideInRight 0.3s ease;
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideOutRight 0.3s ease';
        setTimeout(() => {
            document.body.removeChild(notification);
        }, 300);
    }, 3000);
}

// Добавляем стили для анимации уведомлений
const style = document.createElement('style');
style.textContent = `
    @keyframes slideInRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    @keyframes slideOutRight {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }
`;
document.head.appendChild(style);

// Функции для чтения книг
function openReader(bookId) {
    const book = books.find(b => b.id === bookId);
    if (!book) {
        showNotification('Книга не найдена');
        return;
    }
    
    // Если у книги нет глав, создаём временную структуру с информацией о книге
    if (!book.chapters || book.chapters.length === 0) {
        book.chapters = [{
            title: book.title,
            content: `Автор: ${book.author}\n\n${book.description || 'Описание отсутствует'}\n\n${book.year ? 'Год издания: ' + book.year : ''}\n${book.genre ? 'Жанр: ' + book.genre : ''}\n\nК сожалению, полный текст этой книги пока недоступен.`
        }];
    }
    
    currentReadingBook = book;
    currentChapterIndex = 0;
    displayChapter();
    
    const modal = document.getElementById('readerModal');
    if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden'; // Блокируем скролл фона
    }
}

function closeReader() {
    const modal = document.getElementById('readerModal');
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = ''; // Восстанавливаем скролл
    }
    currentReadingBook = null;
    currentChapterIndex = 0;
}

function changeChapter(direction) {
    if (!currentReadingBook || !currentReadingBook.chapters) return;
    
    currentChapterIndex += direction;
    
    if (currentChapterIndex < 0) {
        currentChapterIndex = 0;
        return;
    }
    
    if (currentChapterIndex >= currentReadingBook.chapters.length) {
        currentChapterIndex = currentReadingBook.chapters.length - 1;
        return;
    }
    
    displayChapter();
}

function displayChapter() {
    if (!currentReadingBook || !currentReadingBook.chapters) return;
    
    const chapter = currentReadingBook.chapters[currentChapterIndex];
    const titleElement = document.getElementById('readerTitle');
    const chapterTitleElement = document.getElementById('chapterTitle');
    const chapterContentElement = document.getElementById('chapterContent');
    const chapterInfoElement = document.getElementById('chapterInfo');
    const prevButton = document.getElementById('prevChapter');
    const nextButton = document.getElementById('nextChapter');
    
    if (titleElement) {
        titleElement.textContent = currentReadingBook.title;
    }
    
    if (chapterTitleElement) {
        chapterTitleElement.textContent = chapter.title || `Глава ${currentChapterIndex + 1}`;
    }
    
    if (chapterContentElement) {
        chapterContentElement.textContent = chapter.content || '';
    }
    
    if (chapterInfoElement) {
        chapterInfoElement.textContent = `Глава ${currentChapterIndex + 1} из ${currentReadingBook.chapters.length}`;
    }
    
    if (prevButton) {
        prevButton.disabled = currentChapterIndex === 0;
        prevButton.style.opacity = currentChapterIndex === 0 ? '0.5' : '1';
    }
    
    if (nextButton) {
        nextButton.disabled = currentChapterIndex === currentReadingBook.chapters.length - 1;
        nextButton.style.opacity = currentChapterIndex === currentReadingBook.chapters.length - 1 ? '0.5' : '1';
    }
}

